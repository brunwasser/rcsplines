<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Steven M. Brunwasser, Ph.D." />

<meta name="date" content="2022-11-17" />

<title>Using Restricted Cubic Splines in Structural Equation Models</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/sandstone.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Applications of Restricted Cubic Splines in SEM</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="about.html">Purpose</a>
</li>
<li>
  <a href="index.html">Demonstrations</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Using Restricted Cubic Splines in
Structural Equation Models</h1>
<h4 class="author">Steven M. Brunwasser, Ph.D.</h4>
<h4 class="date">2022-11-17</h4>

</div>


<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">warning =</span> F,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">message =</span> F </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                      )</span></code></pre></div>
<div id="workspace-prep" class="section level2">
<h2>Workspace Prep</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>( data.table )</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>( ggplot2 )</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>( mgcv )</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>( rms )</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>( Hmisc )</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>( lavaan )</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>( ERP )</span></code></pre></div>
</div>
<div id="demonstration-in-ols-regression" class="section level2">
<h2>Demonstration in OLS regression</h2>
<p>Prior to demonstrating the use of restricted cubic splines (RCSs) in
structural equation models (SEM), we will use RCSs to model a nonlinear
association in an ordinary least squares (OLS) model using the <a
href="">rms</a>. There are several helpful overviews for this package,
including <a
href="https://www.nicholas-ollberding.com/post/an-introduction-to-the-harrell-verse-predictive-modeling-using-the-hmisc-and-rms-packages/">this
one</a> and <a
href="https://www.r-bloggers.com/2016/07/introduction-to-the-rms-package/">this
one</a>.</p>
<p>First, let’s simulate data with a nonlinear association that does not
follow a simple polynomial function. Goldfield and Wujciak-Jens provide
<a
href="https://www.rdatagen.net/post/2022-08-09-simulating-data-from-a-non-linear-function-by-specifying-some-points-on-the-curve/">helpful
code</a> that to accomplish this. Please see their code and explanations
for a detailed explanation of this approach.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">60</span>, <span class="dv">70</span>, <span class="dv">80</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">40</span>, <span class="dv">25</span>, <span class="dv">22</span>, <span class="dv">35</span>, <span class="dv">24</span>, <span class="dv">15</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>dc <span class="ot">&lt;-</span> <span class="fu">copy</span>(dd)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>dc[, xend <span class="sc">:</span><span class="er">=</span> (<span class="fu">shift</span>(x, <span class="at">type =</span> <span class="st">&quot;lead&quot;</span>))]</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>dc[, yend <span class="sc">:</span><span class="er">=</span> (<span class="fu">shift</span>(y, <span class="at">type =</span> <span class="st">&quot;lead&quot;</span>))]</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>dc <span class="ot">&lt;-</span> dc[ <span class="sc">-</span>.N]</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>dc[, id <span class="sc">:</span><span class="er">=</span> .I]</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>dc</span></code></pre></div>
<pre><code>##     x  y xend yend id
## 1: 20 15   30   40  1
## 2: 30 40   40   25  2
## 3: 40 25   50   22  3
## 4: 50 22   60   35  4
## 5: 60 35   70   24  5
## 6: 70 24   80   15  6</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>interp_line <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, xend, yend) {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  slope <span class="ot">&lt;-</span> (yend <span class="sc">-</span> y)<span class="sc">/</span>(xend <span class="sc">-</span> x)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> y <span class="sc">-</span> slope<span class="sc">*</span>x</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  newx <span class="ot">&lt;-</span> <span class="fu">seq</span>(x, xend, <span class="at">length =</span> <span class="dv">100</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  newy <span class="ot">&lt;-</span> newx<span class="sc">*</span>slope <span class="sc">+</span> b</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="at">x =</span> newx, <span class="at">y =</span> newy)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>dx <span class="ot">&lt;-</span> dc[, <span class="fu">interp_line</span>(x, y, xend, yend), keyby <span class="ot">=</span> id]</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>dx</span></code></pre></div>
<pre><code>##      id        x        y
##   1:  1 20.00000 15.00000
##   2:  1 20.10101 15.25253
##   3:  1 20.20202 15.50505
##   4:  1 20.30303 15.75758
##   5:  1 20.40404 16.01010
##  ---                     
## 596:  6 79.59596 15.36364
## 597:  6 79.69697 15.27273
## 598:  6 79.79798 15.18182
## 599:  6 79.89899 15.09091
## 600:  6 80.00000 15.00000</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>gam.fit <span class="ot">&lt;-</span> <span class="fu">gam</span>(y <span class="sc">~</span> <span class="fu">s</span>(x, <span class="at">k =</span> <span class="dv">7</span>), <span class="at">data =</span> dx)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>dx[, ypred <span class="sc">:</span><span class="er">=</span> <span class="fu">predict</span>(gam.fit)]</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>mdata <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">x =</span> <span class="fu">runif</span>(<span class="dv">10000</span>, <span class="dv">20</span>, <span class="dv">85</span>))</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>mdata<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="fu">predict</span>(gam.fit, <span class="at">newdata =</span> mdata) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(mdata),<span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mdata, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>)  <span class="sc">+</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>( <span class="at">breaks =</span> <span class="fu">seq</span>( <span class="dv">20</span>, <span class="dv">80</span>, <span class="dv">5</span> ) )</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> <span class="fu">datadist</span>( mdata )</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>( <span class="at">datadist =</span> <span class="st">&#39;dd&#39;</span> ) </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>ols.rcs5 <span class="ot">&lt;-</span> <span class="fu">ols</span>( y <span class="sc">~</span> <span class="fu">rcs</span>( x, <span class="dv">6</span> ),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> mdata,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> T,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> T )</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>( ols.rcs5 )</span></code></pre></div>
<pre><code>## Linear Regression Model
##  
##  ols(formula = y ~ rcs(x, 6), data = mdata, x = T, y = T)
##  
##                    Model Likelihood    Discrimination    
##                          Ratio Test           Indexes    
##  Obs   10000    LR chi2    21723.01    R2       0.886    
##  sigma2.3470    d.f.              5    R2 adj   0.886    
##  d.f.   9994    Pr(&gt; chi2)   0.0000    g        7.489    
##  
##  Residuals
##  
##       Min       1Q   Median       3Q      Max 
##  -8.40068 -1.58746  0.01796  1.60307 10.24834 
##  
##  
##            Coef     S.E.   t       Pr(&gt;|t|)
##  Intercept -16.0106 0.3258  -49.14 &lt;0.0001 
##  x           1.7298 0.0118  146.56 &lt;0.0001 
##  x&#39;        -19.3577 0.1079 -179.47 &lt;0.0001 
##  x&#39;&#39;        63.8037 0.3429  186.10 &lt;0.0001 
##  x&#39;&#39;&#39;      -89.2816 0.4995 -178.74 &lt;0.0001 
##  x&#39;&#39;&#39;&#39;      67.1363 0.5032  133.43 &lt;0.0001 
## </code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>( ols.rcs5 )</span></code></pre></div>
<pre><code>##                 Analysis of Variance          Response: y 
## 
##  Factor     d.f. Partial SS MS          F        P     
##  x             5 428209.95  85641.99026 15547.58 &lt;.0001
##   Nonlinear    4 310437.00  77609.25011 14089.31 &lt;.0001
##  REGRESSION    5 428209.95  85641.99026 15547.58 &lt;.0001
##  ERROR      9994  55050.75      5.50838</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>ols.pol5 <span class="ot">&lt;-</span> <span class="fu">ols</span>( y <span class="sc">~</span> <span class="fu">pol</span>( x, <span class="dv">5</span> ),</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> mdata,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> T,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> T )</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>( ols.pol5 )</span></code></pre></div>
<pre><code>## Linear Regression Model
##  
##  ols(formula = y ~ pol(x, 5), data = mdata, x = T, y = T)
##  
##                    Model Likelihood    Discrimination    
##                          Ratio Test           Indexes    
##  Obs   10000    LR chi2    18302.93    R2       0.840    
##  sigma2.7847    d.f.              5    R2 adj   0.840    
##  d.f.   9994    Pr(&gt; chi2)   0.0000    g        7.030    
##  
##  Residuals
##  
##       Min       1Q   Median       3Q      Max 
##  -9.31954 -1.95530 -0.04622  1.93245 10.31625 
##  
##  
##            Coef      S.E.   t       Pr(&gt;|t|)
##  Intercept -742.2532 5.1911 -142.99 &lt;0.0001 
##  x           86.5221 0.5953  145.35 &lt;0.0001 
##  x^2         -3.6529 0.0259 -141.24 &lt;0.0001 
##  x^3          0.0730 0.0005  136.49 &lt;0.0001 
##  x^4         -0.0007 0.0000 -131.32 &lt;0.0001 
##  x^5          0.0000 0.0000  125.74 &lt;0.0001 
## </code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>( ols.pol5, <span class="at">tol=</span><span class="fl">1e-15</span> )</span></code></pre></div>
<pre><code>##                 Analysis of Variance          Response: y 
## 
##  Factor     d.f. Partial SS MS          F        P     
##  x             5 405761.83  81152.36624 10465.14 &lt;.0001
##   Nonlinear    4 287988.88  71997.21998  9284.53 &lt;.0001
##  REGRESSION    5 405761.83  81152.36624 10465.14 &lt;.0001
##  ERROR      9994  77498.87      7.75454</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>ols.rcs5.pred <span class="ot">&lt;-</span> <span class="fu">Predict</span>( ols.rcs5, x ) </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>ols.pol5.pred <span class="ot">&lt;-</span> <span class="fu">Predict</span>( ols.pol5, x ) </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>ols5.pred <span class="ot">&lt;-</span> <span class="fu">rbind</span>( ols.rcs5.pred, ols.pol5.pred )</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>ols5.pred<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="fu">rep</span>( <span class="fu">c</span>( <span class="st">&#39;6-Knot RC Spline&#39;</span>,<span class="st">&#39;Quintic Polynomial&#39;</span> ), <span class="at">each =</span> <span class="dv">200</span> )</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>cbbPalette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#E69F00&quot;</span>,<span class="st">&quot;#0072B2&quot;</span> , <span class="st">&quot;#56B4E9&quot;</span>, <span class="st">&quot;#009E73&quot;</span>, <span class="st">&quot;#F0E442&quot;</span>, <span class="st">&quot;#D55E00&quot;</span>, <span class="st">&quot;#CC79A7&quot;</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>ols.pred5.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>( ) <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="at">data=</span>mdata, <span class="fu">aes</span>( <span class="at">x=</span>x, <span class="at">y=</span>y ), <span class="at">color =</span> <span class="st">&#39;darkgray&#39;</span>, <span class="at">shape =</span> <span class="dv">1</span> ) <span class="sc">+</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>( <span class="at">data=</span>ols5.pred, <span class="fu">aes</span>( <span class="at">x=</span>x, <span class="at">y=</span>yhat, <span class="at">group =</span> model, <span class="at">colour=</span>model, <span class="at">linetype =</span> model ), <span class="at">size =</span> <span class="dv">2</span> ) <span class="sc">+</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>( <span class="at">values=</span>cbbPalette ) <span class="sc">+</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>( <span class="at">xintercept =</span> <span class="fu">rcspline.eval</span>( mdata<span class="sc">$</span>x, <span class="at">nk =</span> <span class="dv">6</span>, <span class="at">knots.only =</span> T ), <span class="at">linetype =</span> <span class="dv">3</span> ) <span class="sc">+</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>( <span class="at">breaks =</span> <span class="fu">rcspline.eval</span>( mdata<span class="sc">$</span>x, <span class="at">nk =</span> <span class="dv">6</span>, <span class="at">knots.only =</span> T ),</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;23.15</span><span class="sc">\n</span><span class="st">Knot 1&#39;</span>,<span class="st">&#39;35.06</span><span class="sc">\n</span><span class="st">Knot 2&#39;</span>,<span class="st">&#39;46.74</span><span class="sc">\n</span><span class="st">Knot 3&#39;</span>,<span class="st">&#39;58.04</span><span class="sc">\n</span><span class="st">Knot4&#39;</span>,<span class="st">&#39;69.63</span><span class="sc">\n</span><span class="st">Knot5&#39;</span>,<span class="st">&#39;81.61</span><span class="sc">\n</span><span class="st">Knot 6&#39;</span>)) <span class="sc">+</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">colour=</span><span class="st">&#39;Model Type&#39;</span>,</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">linetype =</span><span class="st">&#39;Model Type&#39;</span>) <span class="sc">+</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">axis.text.x =</span>  <span class="fu">element_text</span>( <span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">&#39;bold&#39;</span>),</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.title =</span> <span class="fu">element_text</span>( <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&#39;bold&#39;</span>),</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.text =</span> <span class="fu">element_text</span>( <span class="at">size =</span> <span class="dv">12</span> ),</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title =</span> <span class="fu">element_text</span>( <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&#39;bold&#39;</span>),</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.position =</span> <span class="st">&#39;bottom&#39;</span> )</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>ols.pred5.plot</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" width="672" />
<br></p>
</div>
<div id="gls-model-with-erp-data" class="section level2">
<h2>GLS Model with ERP Data</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(impulsivity)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(impulsivity)</span></code></pre></div>
<pre><code>## [1] 144 505</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>impulsivity1 <span class="ot">&lt;-</span> <span class="fu">subset</span>( impulsivity, <span class="sc">!</span><span class="fu">duplicated</span>( impulsivity<span class="sc">$</span>Subject ) )</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">&lt;-</span> <span class="fu">reshape</span>( impulsivity1,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">direction =</span> <span class="st">&#39;long&#39;</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">timevar =</span> <span class="st">&#39;time&#39;</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">varying =</span> <span class="fu">list</span>( <span class="at">out =</span> <span class="fu">colnames</span>( impulsivity )[<span class="dv">5</span><span class="sc">:</span><span class="dv">505</span>] ),</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">idvar =</span> <span class="st">&#39;Subject&#39;</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">times =</span> <span class="fu">seq</span>( <span class="dv">0</span>, <span class="dv">1000</span>, <span class="dv">2</span> )</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>                )</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>ddimp <span class="ot">&lt;-</span> <span class="fu">datadist</span>( imp )</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>( <span class="at">datadist =</span> ddimp )</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># imp.rcs7 &lt;- Gls( T_0 ~ rcs( time, 8 ),</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                  correlation = corAR1( form = ~time | Subject  ),</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                  data = imp,</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                  x = T ) </span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co"># save( imp.rcs7, file=&#39;imp.rcs7.RData&#39; )</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>( <span class="st">&#39;imp.rcs7.RData&#39;</span> )</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co"># imp.rcs6 &lt;- Gls( T_0 ~ rcs( time, 7 ),</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                  correlation = corAR1( form = ~time | Subject  ),</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                  data = imp,</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                  x = T )</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="co"># save( imp.rcs6, file=&#39;imp.rcs6.RData&#39; )</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>( <span class="st">&#39;imp.rcs6.RData&#39;</span> )</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="co"># imp.rcs5 &lt;- Gls( T_0 ~ rcs( time, 6 ),</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="co">#                 correlation = corAR1( form = ~time | Subject  ),</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="co">#                  data = imp,</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a><span class="co">#                  x = T )</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a><span class="co"># save( imp.rcs5, file=&#39;imp.rcs5.RData&#39; )</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>( <span class="st">&#39;imp.rcs5.RData&#39;</span> )</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>imp.rcs7.aic <span class="ot">&lt;-</span> <span class="fu">AIC</span>( imp.rcs7 )</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>imp.rcs6.aic <span class="ot">&lt;-</span> <span class="fu">AIC</span>( imp.rcs6 )</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>imp.rcs5.aic <span class="ot">&lt;-</span> <span class="fu">AIC</span>( imp.rcs5 )</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>( <span class="at">AIC =</span> <span class="fu">c</span>(imp.rcs7.aic, imp.rcs6.aic, imp.rcs5.aic ),</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">DF =</span> <span class="fu">c</span>( <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">5</span> ) )</span></code></pre></div>
<pre><code>##        AIC DF
## 1 64298.24  7
## 2 64146.42  6
## 3 64810.86  5</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>( imp.rcs6 )</span></code></pre></div>
<pre><code>## Generalized Least Squares Fit by REML
##  
##  Gls(model = T_0 ~ rcs(time, 7), data = imp, correlation = corAR1(form = ~time | 
##      Subject), x = T)
##  
##                                                      
##    Obs12024    Log-restricted-likelihood-32064.21    
##  Clusters24                        Model d.f.   6    
##     g 3.455                        sigma   3.4750    
##                                    d.f.     12017    
##  
##            Coef    S.E.   t      Pr(&gt;|t|)
##  Intercept  0.3276 0.1491   2.20 0.0281  
##  time      -0.0273 0.0015 -18.45 &lt;0.0001 
##  time&#39;      0.8024 0.0189  42.50 &lt;0.0001 
##  time&#39;&#39;    -2.6273 0.0569 -46.15 &lt;0.0001 
##  time&#39;&#39;&#39;    3.2949 0.0787  41.85 &lt;0.0001 
##  time&#39;&#39;&#39;&#39;  -2.0047 0.0824 -24.33 &lt;0.0001 
##  time&#39;&#39;&#39;&#39;&#39;  0.6655 0.0787   8.45 &lt;0.0001 
##  
##  Correlation Structure: ARMA(1,0)
##   Formula: ~time | Subject 
##   Parameter estimate(s):
##  Phi1 
##     0 
## </code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>( imp.rcs6 )</span></code></pre></div>
<pre><code>##                 Wald Statistics          Response: T_0 
## 
##  Factor     Chi-Square d.f. P     
##  time       9533.83    6    &lt;.0001
##   Nonlinear 8999.03    5    &lt;.0001
##  TOTAL      9533.83    6    &lt;.0001</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># imp.pol6 &lt;- Gls( T_0 ~ pol( time, 6 ),</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                  correlation = corAR1( form = ~time | Subject  ),</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                  data = imp,</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                  x = T )</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># save( imp.pol6, file=&#39;imp.pol6.RData&#39; )</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>( <span class="st">&#39;imp.pol6.RData&#39;</span> )</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>imp.rcs6.pred <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="fu">Predict</span>( imp.rcs6, time ) )</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>imp.rcs6.pred<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="st">&#39;7-Knot RC Spline&#39;</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>imp.pol6.pred <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="fu">Predict</span>( imp.pol6, time ) )</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>imp.pol6.pred<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="st">&#39;Sextic Polynomial&#39;</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>imp6.pred <span class="ot">&lt;-</span> <span class="fu">rbind</span>( imp.rcs6.pred, imp.pol6.pred )</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>imp6.pred<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="fu">factor</span>( imp6.pred<span class="sc">$</span>model )</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>impplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>( ) <span class="sc">+</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>( <span class="at">data=</span>imp, <span class="fu">aes</span>( <span class="at">x=</span>time, <span class="at">y=</span>T_0, <span class="at">group =</span> Subject  ), <span class="at">colour=</span><span class="st">&#39;darkgray&#39;</span> ) <span class="sc">+</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>( <span class="at">data=</span>imp6.pred, <span class="fu">aes</span>( time, yhat, <span class="at">group =</span> model, <span class="at">colour =</span> model, <span class="at">linetype=</span>model ), <span class="at">size=</span><span class="dv">1</span> ) <span class="sc">+</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>( <span class="at">data=</span>imp6.pred, <span class="fu">aes</span>( <span class="at">x=</span>time, <span class="at">ymin=</span>lower, <span class="at">ymax=</span>upper, <span class="at">fill=</span>model ), <span class="at">alpha =</span> .<span class="dv">3</span> ) <span class="sc">+</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>( <span class="at">xintercept =</span> <span class="fu">rcspline.eval</span>( imp<span class="sc">$</span>time, <span class="at">nk =</span> <span class="dv">7</span>, <span class="at">knots.only =</span> T ), <span class="at">linetype =</span> <span class="dv">3</span> ) <span class="sc">+</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>( <span class="at">values=</span>cbbPalette) <span class="sc">+</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>( <span class="at">values=</span>cbbPalette) <span class="sc">+</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>( <span class="at">breaks =</span> <span class="fu">rcspline.eval</span>( imp<span class="sc">$</span>time, <span class="at">nk =</span> <span class="dv">7</span>, <span class="at">knots.only =</span> T ),</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;24</span><span class="sc">\n</span><span class="st">Knot 1&#39;</span>,<span class="st">&#39;182</span><span class="sc">\n</span><span class="st">Knot 2&#39;</span>,<span class="st">&#39;342</span><span class="sc">\n</span><span class="st">Knot 3&#39;</span>,<span class="st">&#39;500</span><span class="sc">\n</span><span class="st">Knot 4&#39;</span>,<span class="st">&#39;658</span><span class="sc">\n</span><span class="st">Knot 5&#39;</span>,<span class="st">&#39;818</span><span class="sc">\n</span><span class="st">Knot 6&#39;</span>,<span class="st">&#39;976</span><span class="sc">\n</span><span class="st">Knot 7&#39;</span>)) <span class="sc">+</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">y=</span><span class="st">&#39;ERP Amplitude&#39;</span>, <span class="at">x=</span><span class="st">&#39;Time (ms)&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;Model Type&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;Model Type&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;Model Type&#39;</span>) <span class="sc">+</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">legend.position =</span> <span class="st">&#39;bottom&#39;</span> )</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>impplot</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
<div id="latent-growth-curve-model-perceived-stress-trajectories"
class="section level2">
<h2>Latent Growth Curve Model: Perceived Stress Trajectories</h2>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>( <span class="st">&#39;cts.splines.Rdata&#39;</span> )</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span>( <span class="fu">describe</span>( cts.splines ) )</span></code></pre></div>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<script type="text/javascript">
<!--
    function expand_collapse(id) {
       var e = document.getElementById(id);
       var f = document.getElementById(id+"_earrows");
       if(e.style.display == 'none'){
          e.style.display = 'block';
          f.innerHTML = '&#9650';
       }
       else {
          e.style.display = 'none';
          f.innerHTML = '&#9660';
       }
    }
//-->
</script>
<style>
.earrows {color:silver;font-size:11px;}

fcap {
 font-family: Verdana;
 font-size: 12px;
 color: MidnightBlue
 }

smg {
 font-family: Verdana;
 font-size: 10px;
 color: &#808080;
}

hr.thinhr { margin-top: 0.15em; margin-bottom: 0.15em; }

span.xscript {
position: relative;
}
span.xscript sub {
position: absolute;
left: 0.1em;
bottom: -1ex;
}
</style>
 <font color="MidnightBlue"><div align=center><span style="font-weight:bold">cts.splines <br><br> 5  Variables   656  Observations</span></div></font> <hr class="thinhr"> <span style="font-weight:bold">id</span>: Unique participant identifier<div style='float: right; text-align: right;'><img src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAJcAAAANCAMAAACTvAxuAAAACVBMVEUAAADMzMz////1iUV5AAAAYUlEQVQ4je2TMQpAMQhDG+9/6E9rItROfyh0iIupeUgoOICRhVmUW5M+ASk6aBNO0XctW0wCxZUdwUfMotya9AlI0Yk24TT6rmWLSaC4sp3LuW7m8j3++y/ncq6buR69xw9LQQTEAnSbxwAAAABJRU5ErkJggg==" alt="image" /></div> <style>
 .hmisctable179102 {
 border: none;
 font-size: 85%;
 }
 .hmisctable179102 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable179102 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table class="hmisctable179102">
 <tr><th>n</th><th>missing</th><th>distinct</th></tr>
 <tr><td>656</td><td>0</td><td>82</td></tr>
 </table>
 <span style="font-size: 85%;"><font color="MidnightBlue">lowest</font> : 1074614  1765339  2882872  4269441  8864786  ,  <font color="MidnightBlue">highest</font>: 98980864 99999996 99999997 99999998 99999999</span> <hr class="thinhr"> <span style="font-weight:bold">psstot</span>: Composite Perceived Stress Score<div style='float: right; text-align: right;'><img src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAH8AAAANCAMAAAC3iUHrAAAACVBMVEUAAADMzMz////1iUV5AAAAhklEQVQ4jdWTiwrAIAhFr/v/j16PNXpo6laDiagYeQxuoOcGvLhcZhx+Q7CcuxgCnAOX8JOXvIcvsz7g36MHFtf7F98i8RBbHxpdb5H+K6E53l+LU3//BC6ADHz7FsL5DLSFj6pQQD6+sgGPXcMXvkWzUdQqosIZRQtCN+ifa9NFSjVySXQCxaYH70IapV4AAAAASUVORK5CYII=" alt="image" /></div> <style>
 .hmisctable801649 {
 border: none;
 font-size: 85%;
 }
 .hmisctable801649 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable801649 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table class="hmisctable801649">
 <tr><th>n</th><th>missing</th><th>distinct</th><th>Info</th><th>Mean</th><th>Gmd</th><th>.05</th><th>.10</th><th>.25</th><th>.50</th><th>.75</th><th>.90</th><th>.95</th></tr>
 <tr><td>607</td><td>49</td><td>42</td><td>0.998</td><td>22.5</td><td>8.82</td><td>10</td><td>12</td><td>17</td><td>23</td><td>28</td><td>32</td><td>35</td></tr>
 </table>
 <span style="font-size: 85%;"><font color="MidnightBlue">lowest</font> :  3  4  5  6  7 ,  <font color="MidnightBlue">highest</font>: 41 42 43 44 45</span> <hr class="thinhr"> <span style="font-weight:bold">sex</span>: Participant-Reported Sex <style>
 .hmisctable353050 {
 border: none;
 font-size: 85%;
 }
 .hmisctable353050 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable353050 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table class="hmisctable353050">
 <tr><th>n</th><th>missing</th><th>distinct</th></tr>
 <tr><td>656</td><td>0</td><td>2</td></tr>
 </table>
 <pre style="font-size:85%;">
 Value      Female   Male
 Frequency     376    280
 Proportion  0.573  0.427
 </pre>
 <hr class="thinhr"> <span style="font-weight:bold">dasct</span>: Compsite Dysfunctional Attitudes Score (mean centered)<div style='float: right; text-align: right;'><img src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAJcAAAANCAMAAACTvAxuAAAACVBMVEUAAADMzMz////1iUV5AAAAi0lEQVQ4je1TWwrAIAyL3v/Qw6WDPlQcK9s+7EeRtCShGJSMAlJoNGPNKOTQaMYclu98UXpgYPsaSL/nayltkMiBpRPIWQikXZq8H+QR7RznScSXvhBn4WB2afIeaf7Xl9myEtenctWBiEurbpNQ8KWgMN2+bvpy6Wg0PjhBvwMRl1bcJqGQRwWF6QHSPAq29oz/zAAAAABJRU5ErkJggg==" alt="image" /></div> <pre style="font-size:85%;">
         n   missing  distinct      Info      Mean       Gmd       .05       .10 
       648         8        61     0.999 1.368e-14     31.62   -37.528   -30.528 
       .25       .50       .75       .90       .95 
   -19.528    -2.528    15.472    38.472    54.472 
 </pre>
 <style>
 .hmisctable594728 {
 border: none;
 font-size: 85%;
 }
 .hmisctable594728 td {
 text-align: right;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable594728 th {
 color: Black;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: bold;
 }
 </style>
 <table class="hmisctable594728">
 <tr><td><font color="MidnightBlue">lowest</font> :</td><td>-66.52843</td><td>-52.52843</td><td>-50.52843</td><td>-38.52843</td><td>-37.52843</td></tr>
 <tr><td><font color="MidnightBlue">highest</font>:</td><td> 42.47157</td><td> 54.47157</td><td> 62.47157</td><td> 73.47157</td><td> 86.47157</td></tr>
 </table>
 <hr class="thinhr"> <span style="font-weight:bold">weeks</span>: Week of Follow-up (0=Baseline)<div style='float: right; text-align: right;'><img src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAABkAAAANCAMAAABrcDXcAAAACVBMVEUAAADMzMz////1iUV5AAAAIElEQVQYlWNgYGRkYAAhGIZQIMDEBMRQCsGkp8xQdBsAmoEA55cm0HQAAAAASUVORK5CYII=" alt="image" /></div> <style>
 .hmisctable275145 {
 border: none;
 font-size: 85%;
 }
 .hmisctable275145 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable275145 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table class="hmisctable275145">
 <tr><th>n</th><th>missing</th><th>distinct</th><th>Info</th><th>Mean</th><th>Gmd</th></tr>
 <tr><td>656</td><td>0</td><td>8</td><td>0.984</td><td>6.875</td><td>5.039</td></tr>
 </table>
 <span style="font-size: 85%;"><font color="MidnightBlue">lowest</font> :  0  2  4  6  8 ,  <font color="MidnightBlue">highest</font>:  6  8 10 12 13</span> <pre style="font-size:85%;">
 Value          0     2     4     6     8    10    12    13
 Frequency     82    82    82    82    82    82    82    82
 Proportion 0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125
 </pre>
 <hr class="thinhr">
<p>Create a wide version of the CTS data for latent growth modeling.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>cts.wide <span class="ot">&lt;-</span> <span class="fu">reshape</span>( cts.splines,</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">direction =</span> <span class="st">&#39;wide&#39;</span>,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">v.names =</span> <span class="st">&#39;psstot&#39;</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">timevar =</span> <span class="st">&#39;weeks&#39;</span>,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">idvar =</span> <span class="st">&#39;id&#39;</span>,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sep =</span> <span class="st">&#39;&#39;</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>                     )</span></code></pre></div>
<p>We do not want to make the assumption that the time-invariant
dysfunctional attitudes variable (<em>dasct</em>) affects stress
trajectories in a linear manner; rather, we would like to at least allow
for possible non-linearity. We’ll model the effect of <em>dasct</em>
with a 3-knot restricted cubic spline allowing the knots to be placed at
their default values (outer knots placed at the 0.10 and 0.90 quantiles
of <em>dasct</em>). There is no equivalent to the <strong>rcs()</strong>
function provided in the <em>rms</em> package in the <em>lavaan</em>
package. Consequently, we need to create <span
class="math inline">\(k-1\)</span> time variables (where <span
class="math inline">\(k\)</span> is the number of knots) to include in
the <em>cts.wide</em> data frame in order to estimate the nonlinear
effect. We use the <strong>rcspline.eval()</strong> function (rms
package) to create new nonlinear time variable
(<em>dasct.nonlinear</em>) needed to estimate a 3-knot restricted cubic
spline effect of dysfunctional attitudes on stress trajectories, then
creating a new data frame (<em>cts.wide1</em>) that merges this new
nonlinear variable with the <em>cts.wide</em> data frame. We can then
estimate the 3-knot restricted cubic spline effect by including both the
<em>dasct</em> and the <em>dasct.nonlinear</em> variables as predictors
in the model, representing the linear and nonlinear effects,
respectively.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>das.spline <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="fu">rcspline.eval</span>( cts.wide<span class="sc">$</span>dasct, <span class="at">nk =</span> <span class="dv">3</span> ) )</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>( das.spline ) <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">&#39;dasct.nonlinear&#39;</span> )</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>cts.wide1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>( cts.wide, das.spline )</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>( cts.wide1 )</span></code></pre></div>
<pre><code>##          id    sex      dasct psstot0 psstot2 psstot4 psstot6 psstot8 psstot10
## 1   1074614 Female -10.528432      26      43      23      20      23       29
## 9   1765339   Male -50.528432       8      15      15      16       6       32
## 17  2882872 Female  23.471568      33      26      25      20      27       18
## 25  4269441 Female -27.528432      15      24      29      26      26       30
## 33  8864786 Female -31.528432      14      24      18      13      16       14
## 41 10417541 Female   4.471568      26      23      26      20      26       29
##    psstot12 psstot13 dasct.nonlinear
## 1        28       NA      2.32549622
## 9        18       21      0.00000000
## 17       22        9     23.46558593
## 25       27       33      0.11814745
## 33       15       11      0.02551985
## 41       26       32      8.68790004</code></pre>
<p>We also want to use a 3-knot restricted cubic spline to estimate a
nonlinear stress trajectory. Unlike in standard regression models where
time effects are captured by observed variables included in the dataset,
time effects are captured by latent (unobserved) intercept &amp; slope
variables (“growth factors”) in latent growth curve (LGC) models. The
factor loadings are (typically) fixed at values selected to model a
specific trajectory shape. To model a nonlinear trajectory using a
restricted cubic spline, we need to have <span
class="math inline">\(k-1\)</span> latent slope variables to capture the
time effect; so we need 2 latent slope factors to estimate a 3-knot
restricted cubic spline. Note, this is the same number of latent slopes
needed to estimate a quadratic growth curve model. The question is: how
do we constrain the factor loadings in order to estimate the appropriate
restricted cubic spline trajectory. Again, the
<strong>rcspline.eval()</strong> function can help us so that we don’t
have to figure it manually.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>knots <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="fu">rcspline.eval</span>( cts.splines<span class="sc">$</span>weeks, <span class="at">nk =</span> <span class="dv">3</span>, <span class="at">knots =</span> <span class="fu">c</span>( <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">14</span> ), <span class="at">inclx =</span> T ) )</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>knots1 <span class="ot">&lt;-</span> knots[ <span class="sc">!</span><span class="fu">duplicated</span>( knots<span class="sc">$</span>x ), ] </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>( knots1 ) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Linear Slope&#39;</span>,<span class="st">&#39;Nonlinear Slope&#39;</span> )</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>knots1</span></code></pre></div>
<pre><code>##   Linear Slope Nonlinear Slope
## 1            0        0.000000
## 2            2        0.000000
## 3            4        0.000000
## 4            6        0.080000
## 5            8        0.640000
## 6           10        2.026667
## 7           12        4.053333
## 8           13        5.206667</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>stress.lgc1 <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="st">## Define the latent growth factors -- intercept, linear slope, and nonlinear slope</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="st">i =~ 1*psstot0 + 1*psstot2 + 1*psstot4 + 1*psstot6 + 1*psstot8 + 1*psstot10 + 1*psstot12 + 1*psstot13</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="st">lin =~ 0*psstot0 + 2*psstot2 + 4*psstot4 + 6*psstot6 + 8*psstot8 + 10*psstot10 + 12*psstot12 + 13*psstot13</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="st">nonlin =~ 0*psstot0 + 0*psstot2 + 0*psstot4 + 0.08*psstot6 + 0.64*psstot8 + 2.026667*psstot10 + 4.053333*psstot12 + 5.206667*psstot13</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="st">## Estimate first-order autoregressive effect -- hold effect constant over time by giving each the same label -- phi</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="st"># psstot13 ~ phi*psstot12</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="st"># psstot12 ~ phi*psstot10</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="st"># psstot10 ~ phi*psstot8</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="st"># psstot8 ~ phi*psstot6</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="st"># psstot6 ~ phi*psstot4</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="st"># psstot4 ~ phi*psstot2</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="st"># psstot2 ~ phi*psstot0</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="st">## Constrain variances of latent growth models to = 0 -- i.e., no random effects</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="st">i ~~ i</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="st">lin ~~ lin</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="st">nonlin ~~ nonlin</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="st">i ~~ lin</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="st">i ~~ nonlin</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a><span class="st">lin ~~ nonlin</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="st">## Constrain error variances to be constant over time</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a><span class="st">psstot0 ~~ e*psstot0</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a><span class="st">psstot2 ~~ e*psstot2</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a><span class="st">psstot4 ~~ e*psstot4</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a><span class="st">psstot6 ~~ e*psstot6</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a><span class="st">psstot8 ~~ e*psstot8</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a><span class="st">psstot10 ~~ e*psstot10</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a><span class="st">psstot12 ~~ e*psstot12</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a><span class="st">psstot13 ~~ e*psstot13</span></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a><span class="st">## Estimate effects of DAS on stress trajectories</span></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a><span class="st">i  ~ dasct + dasct.nonlinear</span></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span> </span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>stress.lgc1.fit <span class="ot">&lt;-</span> <span class="fu">growth</span>( stress.lgc1,</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> cts.wide1,</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>                          <span class="at">estimator =</span> <span class="st">&#39;ml&#39;</span> )</span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>( stress.lgc1.fit, <span class="at">fit.measures =</span> T )</span></code></pre></div>
<pre><code>## lavaan 0.6-11 ended normally after 93 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        19
##   Number of equality constraints                     7
##                                                       
##                                                   Used       Total
##   Number of observations                            63          82
##                                                                   
## Model Test User Model:
##                                                       
##   Test statistic                                49.925
##   Degrees of freedom                                48
##   P-value (Chi-square)                           0.397
## 
## Model Test Baseline Model:
## 
##   Test statistic                               342.288
##   Degrees of freedom                                44
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    0.994
##   Tucker-Lewis Index (TLI)                       0.994
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -1579.151
##   Loglikelihood unrestricted model (H1)      -1554.188
##                                                       
##   Akaike (AIC)                                3182.301
##   Bayesian (BIC)                              3208.019
##   Sample-size adjusted Bayesian (BIC)         3170.257
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.025
##   90 Percent confidence interval - lower         0.000
##   90 Percent confidence interval - upper         0.087
##   P-value RMSEA &lt;= 0.05                          0.674
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.092
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   i =~                                                
##     psstot0           1.000                           
##     psstot2           1.000                           
##     psstot4           1.000                           
##     psstot6           1.000                           
##     psstot8           1.000                           
##     psstot10          1.000                           
##     psstot12          1.000                           
##     psstot13          1.000                           
##   lin =~                                              
##     psstot0           0.000                           
##     psstot2           2.000                           
##     psstot4           4.000                           
##     psstot6           6.000                           
##     psstot8           8.000                           
##     psstot10         10.000                           
##     psstot12         12.000                           
##     psstot13         13.000                           
##   nonlin =~                                           
##     psstot0           0.000                           
##     psstot2           0.000                           
##     psstot4           0.000                           
##     psstot6           0.080                           
##     psstot8           0.640                           
##     psstot10          2.027                           
##     psstot12          4.053                           
##     psstot13          5.207                           
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   i ~                                                 
##     dasct             0.127    0.060    2.137    0.033
##     dasct.nonliner   -0.070    0.087   -0.803    0.422
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##  .i ~~                                                
##     lin              -0.703    0.884   -0.795    0.426
##     nonlin           -0.964    1.809   -0.533    0.594
##   lin ~~                                              
##     nonlin           -1.057    0.410   -2.575    0.010
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .psstot0           0.000                           
##    .psstot2           0.000                           
##    .psstot4           0.000                           
##    .psstot6           0.000                           
##    .psstot8           0.000                           
##    .psstot10          0.000                           
##    .psstot12          0.000                           
##    .psstot13          0.000                           
##    .i                22.682    1.316   17.232    0.000
##     lin               0.118    0.133    0.884    0.377
##     nonlin           -0.418    0.294   -1.424    0.155
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .i                25.467    6.583    3.868    0.000
##     lin               0.619    0.203    3.055    0.002
##     nonlin            2.876    0.989    2.907    0.004
##    .psstot0    (e)   18.082    1.441   12.550    0.000
##    .psstot2    (e)   18.082    1.441   12.550    0.000
##    .psstot4    (e)   18.082    1.441   12.550    0.000
##    .psstot6    (e)   18.082    1.441   12.550    0.000
##    .psstot8    (e)   18.082    1.441   12.550    0.000
##    .psstot10   (e)   18.082    1.441   12.550    0.000
##    .psstot12   (e)   18.082    1.441   12.550    0.000
##    .psstot13   (e)   18.082    1.441   12.550    0.000</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>stress.lgc2 <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="st">## Define the latent growth factors -- intercept, linear slope, and nonlinear slope</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="st">i =~ 1*psstot0 + 1*psstot2 + 1*psstot4 + 1*psstot6 + 1*psstot8 + 1*psstot10 + 1*psstot12 + 1*psstot13</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="st">lin =~ 0*psstot0 + 2*psstot2 + 4*psstot4 + 6*psstot6 + 8*psstot8 + 10*psstot10 + 12*psstot12 + 13*psstot13</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="st">## Estimate first-order autoregressive effect -- hold effect constant over time by giving each the same label -- phi</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="st"># psstot13 ~ phi*psstot12</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="st"># psstot12 ~ phi*psstot10</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="st"># psstot10 ~ phi*psstot8</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="st"># psstot8 ~ phi*psstot6</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="st"># psstot6 ~ phi*psstot4</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="st"># psstot4 ~ phi*psstot2</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="st"># psstot2 ~ phi*psstot0</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="st">## Constrain variances of latent growth models to = 0 -- i.e., no random effects</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="st">i ~~ i</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="st">lin ~~ lin</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="st">i ~~ lin</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="st">## Constrain error variances to be constant over time</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="st">psstot0 ~~ e*psstot0</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="st">psstot2 ~~ e*psstot2</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a><span class="st">psstot4 ~~ e*psstot4</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a><span class="st">psstot6 ~~ e*psstot6</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a><span class="st">psstot8 ~~ e*psstot8</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a><span class="st">psstot10 ~~ e*psstot10</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a><span class="st">psstot12 ~~ e*psstot12</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a><span class="st">psstot13 ~~ e*psstot13</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a><span class="st">## Estimate effects of DAS on stress trajectories</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a><span class="st">i  ~ dasct + dasct.nonlinear</span></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span> </span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>stress.lgc2.fit <span class="ot">&lt;-</span> <span class="fu">growth</span>( stress.lgc2,</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> cts.wide1,</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>                          <span class="at">estimator =</span> <span class="st">&#39;ml&#39;</span> )</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>( stress.lgc2.fit, <span class="at">fit.measures =</span> T )</span></code></pre></div>
<pre><code>## lavaan 0.6-11 ended normally after 79 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        15
##   Number of equality constraints                     7
##                                                       
##                                                   Used       Total
##   Number of observations                            63          82
##                                                                   
## Model Test User Model:
##                                                       
##   Test statistic                                77.809
##   Degrees of freedom                                52
##   P-value (Chi-square)                           0.012
## 
## Model Test Baseline Model:
## 
##   Test statistic                               342.288
##   Degrees of freedom                                44
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    0.913
##   Tucker-Lewis Index (TLI)                       0.927
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -1593.092
##   Loglikelihood unrestricted model (H1)      -1554.188
##                                                       
##   Akaike (AIC)                                3202.185
##   Bayesian (BIC)                              3219.330
##   Sample-size adjusted Bayesian (BIC)         3194.156
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.089
##   90 Percent confidence interval - lower         0.043
##   90 Percent confidence interval - upper         0.128
##   P-value RMSEA &lt;= 0.05                          0.074
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.117
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   i =~                                                
##     psstot0           1.000                           
##     psstot2           1.000                           
##     psstot4           1.000                           
##     psstot6           1.000                           
##     psstot8           1.000                           
##     psstot10          1.000                           
##     psstot12          1.000                           
##     psstot13          1.000                           
##   lin =~                                              
##     psstot0           0.000                           
##     psstot2           2.000                           
##     psstot4           4.000                           
##     psstot6           6.000                           
##     psstot8           8.000                           
##     psstot10         10.000                           
##     psstot12         12.000                           
##     psstot13         13.000                           
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   i ~                                                 
##     dasct             0.110    0.063    1.754    0.079
##     dasct.nonliner   -0.051    0.092   -0.558    0.577
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##  .i ~~                                                
##     lin              -0.982    0.531   -1.850    0.064
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .psstot0           0.000                           
##    .psstot2           0.000                           
##    .psstot4           0.000                           
##    .psstot6           0.000                           
##    .psstot8           0.000                           
##    .psstot10          0.000                           
##    .psstot12          0.000                           
##    .psstot13          0.000                           
##    .i                22.941    1.380   16.621    0.000
##     lin              -0.043    0.074   -0.585    0.559
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .i                29.977    7.035    4.261    0.000
##     lin               0.208    0.063    3.310    0.001
##    .psstot0    (e)   21.678    1.577   13.748    0.000
##    .psstot2    (e)   21.678    1.577   13.748    0.000
##    .psstot4    (e)   21.678    1.577   13.748    0.000
##    .psstot6    (e)   21.678    1.577   13.748    0.000
##    .psstot8    (e)   21.678    1.577   13.748    0.000
##    .psstot10   (e)   21.678    1.577   13.748    0.000
##    .psstot12   (e)   21.678    1.577   13.748    0.000
##    .psstot13   (e)   21.678    1.577   13.748    0.000</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>( stress.lgc1.fit, stress.lgc2.fit )</span></code></pre></div>
<pre><code>## Chi-Squared Difference Test
## 
##                 Df    AIC    BIC  Chisq Chisq diff Df diff Pr(&gt;Chisq)    
## stress.lgc1.fit 48 3182.3 3208.0 49.925                                  
## stress.lgc2.fit 52 3202.2 3219.3 77.809     27.884       4  1.317e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>dd.cts <span class="ot">&lt;-</span> <span class="fu">datadist</span>( cts.splines )</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>( <span class="at">datadist =</span> <span class="st">&#39;dd.cts&#39;</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>gls.stress1 <span class="ot">&lt;-</span> <span class="fu">Gls</span>( psstot <span class="sc">~</span> <span class="fu">rcs</span>( weeks, <span class="dv">3</span>),</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">correlation =</span> <span class="fu">corAR1</span>( <span class="at">form =</span><span class="sc">~</span> weeks <span class="sc">|</span> id ),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> cts.splines,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> T )</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>( gls.stress1 )</span></code></pre></div>
<pre><code>##              Effects              Response : psstot 
## 
##  Factor Low High Diff. Effect   S.E.    Lower 0.95 Upper 0.95
##  weeks  3.5 10.5 7     -0.38106 0.68087 -1.7155    0.95343</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>( gls.stress1 )</span></code></pre></div>
<pre><code>## Generalized Least Squares Fit by REML
##  
##  Gls(model = psstot ~ rcs(weeks, 3), data = cts.splines, correlation = corAR1(form = ~weeks | 
##      id), x = T)
##  
##                                                     
##     Obs 607    Log-restricted-likelihood-1970.90    
##  Clusters82                        Model d.f.  2    
##     g 0.661                        sigma  7.8908    
##                                    d.f.      604    
##  
##            Coef    S.E.   t     Pr(&gt;|t|)
##  Intercept 21.8348 0.8704 25.08 &lt;0.0001 
##  weeks      0.3583 0.2200  1.63 0.1038  
##  weeks&#39;    -0.5164 0.2823 -1.83 0.0678  
##  
##  Correlation Structure: ARMA(1,0)
##   Formula: ~weeks | id 
##   Parameter estimate(s):
##       Phi1 
##  0.7886409 
## </code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>lme.stress1 <span class="ot">&lt;-</span> <span class="fu">lme</span>( psstot <span class="sc">~</span> <span class="fu">rcs</span>( weeks, <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">rcs</span>( dasct, <span class="dv">3</span> ),</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span><span class="sc">~</span> <span class="fu">rcs</span>( weeks, <span class="dv">3</span> ) <span class="sc">|</span> id,</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> cts.splines,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">na.action =</span> <span class="st">&#39;na.omit&#39;</span>,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">&#39;ML&#39;</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>( lme.stress1 )</span></code></pre></div>
<pre><code>## Linear mixed-effects model fit by maximum likelihood
##   Data: cts.splines 
##        AIC      BIC    logLik
##   3874.445 3927.268 -1925.223
## 
## Random effects:
##  Formula: ~rcs(weeks, 3) | id
##  Structure: General positive-definite, Log-Cholesky parametrization
##                     StdDev   Corr         
## (Intercept)         5.396515 (Intr) rc(,3)
## rcs(weeks, 3)weeks  1.162322 -0.165       
## rcs(weeks, 3)weeks&#39; 1.422736 -0.055 -0.904
## Residual            4.532727              
## 
## Fixed effects:  psstot ~ rcs(weeks, 3) + rcs(dasct, 3) 
##                         Value Std.Error  DF   t-value p-value
## (Intercept)         22.398413 1.2119137 520 18.481855  0.0000
## rcs(weeks, 3)weeks   0.258956 0.1846890 520  1.402122  0.1615
## rcs(weeks, 3)weeks&#39; -0.353792 0.2329251 520 -1.518908  0.1294
## rcs(dasct, 3)dasct   0.101483 0.0513904  78  1.974751  0.0518
## rcs(dasct, 3)dasct&#39; -0.028816 0.0656129  78 -0.439187  0.6617
##  Correlation: 
##                     (Intr) rcs(w,3) rcs(w,3)&#39; rcs(d,3)
## rcs(weeks, 3)weeks  -0.259                            
## rcs(weeks, 3)weeks&#39;  0.133 -0.924                     
## rcs(dasct, 3)dasct   0.719 -0.004   -0.009            
## rcs(dasct, 3)dasct&#39; -0.791  0.002    0.010    -0.911  
## 
## Standardized Within-Group Residuals:
##          Min           Q1          Med           Q3          Max 
## -3.242539495 -0.510464285  0.005227876  0.495163629  3.415296110 
## 
## Number of Observations: 603
## Number of Groups: 81</code></pre>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
